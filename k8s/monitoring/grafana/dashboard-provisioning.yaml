# Grafana Dashboard Provisioning Configuration
# File: k8s/monitoring/grafana/dashboard-provisioning.yaml
# Auto-load dashboards from ConfigMaps on Grafana startup

apiVersion: v1
kind: ConfigMap
metadata:
  name: grafana-dashboard-provisioning
  namespace: monitoring
  labels:
    app: grafana
data:
  dashboards.yaml: |
    apiVersion: 1
    providers:
      - name: 'UITGo Dashboards'
        orgId: 1
        folder: 'UITGo'
        folderUid: 'uitgo'
        type: file
        disableDeletion: false
        updateIntervalSeconds: 30
        allowUiUpdates: true
        options:
          path: /var/lib/grafana/dashboards/uitgo
          foldersFromFilesStructure: false

---
apiVersion: v1
kind: ConfigMap
metadata:
  name: grafana-dashboards-uitgo
  namespace: monitoring
  labels:
    app: grafana
    grafana_dashboard: "1"
data:
  uitgo-overview.json: |
    {
      "annotations": { "list": [] },
      "editable": true,
      "fiscalYearStartMonth": 0,
      "graphTooltip": 1,
      "id": null,
      "links": [],
      "liveNow": false,
      "panels": [
        {
          "id": 1,
          "title": " Services Status",
          "type": "stat",
          "gridPos": { "h": 4, "w": 8, "x": 0, "y": 0 },
          "targets": [{ "expr": "sum(up{job=~\"uitgo.*\"})", "legendFormat": "UP" }],
          "fieldConfig": { "defaults": { "thresholds": { "steps": [{"color": "red", "value": null}, {"color": "yellow", "value": 2}, {"color": "green", "value": 3}] } } }
        },
        {
          "id": 2,
          "title": " Total Goroutines",
          "type": "stat",
          "gridPos": { "h": 4, "w": 8, "x": 8, "y": 0 },
          "targets": [{ "expr": "sum(go_goroutines{job=~\"uitgo.*\"})", "legendFormat": "Goroutines" }],
          "fieldConfig": { "defaults": { "thresholds": { "steps": [{"color": "green", "value": null}, {"color": "yellow", "value": 100}, {"color": "red", "value": 500}] } } }
        },
        {
          "id": 3,
          "title": " Total Memory",
          "type": "stat",
          "gridPos": { "h": 4, "w": 8, "x": 16, "y": 0 },
          "targets": [{ "expr": "sum(go_memstats_heap_alloc_bytes{job=~\"uitgo.*\"}) / 1024 / 1024", "legendFormat": "MB" }],
          "fieldConfig": { "defaults": { "unit": "MB", "thresholds": { "steps": [{"color": "green", "value": null}, {"color": "yellow", "value": 256}, {"color": "red", "value": 512}] } } }
        },
        {
          "id": 4,
          "title": " Memory Over Time",
          "type": "timeseries",
          "gridPos": { "h": 8, "w": 12, "x": 0, "y": 4 },
          "targets": [{ "expr": "go_memstats_heap_alloc_bytes{job=~\"uitgo.*\"} / 1024 / 1024", "legendFormat": "{{job}}" }],
          "fieldConfig": { "defaults": { "unit": "MB" } }
        },
        {
          "id": 5,
          "title": " Goroutines Over Time",
          "type": "timeseries",
          "gridPos": { "h": 8, "w": 12, "x": 12, "y": 4 },
          "targets": [{ "expr": "go_goroutines{job=~\"uitgo.*\"}", "legendFormat": "{{job}}" }]
        }
      ],
      "schemaVersion": 38,
      "tags": ["uitgo", "overview"],
      "title": "UITGo Overview",
      "uid": "uitgo-overview-auto",
      "version": 1
    }
